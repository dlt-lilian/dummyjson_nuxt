/**
 * name: @tresjs/core
 * version: v4.1.0
 * (c) 2024
 * description: Declarative ThreeJS using Vue Components
 * author: Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)
 */
(function(P,p){typeof exports=="object"&&typeof module<"u"?p(exports,require("vue"),require("three"),require("@vueuse/core")):typeof define=="function"&&define.amd?define(["exports","vue","three","@vueuse/core"],p):(P=typeof globalThis<"u"?globalThis:P||self,p(P.tres={},P.Vue,P.Three,P.VueUseCore))})(this,function(P,p,y,S){"use strict";var rn=Object.defineProperty;var on=(P,p,y)=>p in P?rn(P,p,{enumerable:!0,configurable:!0,writable:!0,value:y}):P[p]=y;var me=(P,p,y)=>(on(P,typeof p!="symbol"?p+"":p,y),y);function Ze(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const n in e)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:()=>e[n]})}}return t.default=e,Object.freeze(t)}const ge=Ze(y),et={name:"@tresjs/core",type:"module",version:"4.1.0",packageManager:"pnpm@9.1.4",description:"Declarative ThreeJS using Vue Components",author:"Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",license:"MIT",keywords:["vue","3d","threejs","three","threejs-vue"],sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},main:"./dist/tres.js",module:"./dist/tres.js",types:"./dist/index.d.ts",files:["*.d.ts","dist"],publishConfig:{access:"public"},scripts:{dev:"cd playground && npm run dev",build:"vite build",playground:"cd playground && npm run dev",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts",prepare:"node .husky/install.mjs"},peerDependencies:{three:">=0.133",vue:">=3.4"},dependencies:{"@alvarosabu/utils":"^3.2.0","@vue/devtools-api":"^6.6.2","@vueuse/core":"^10.10.0"},devDependencies:{"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.10.0","@tresjs/cientos":"3.9.0","@tresjs/eslint-config":"^1.1.0","@types/three":"^0.165.0","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","@vitejs/plugin-vue":"^5.0.5","@vitest/coverage-c8":"^0.33.0","@vitest/coverage-v8":"^1.6.0","@vitest/ui":"^1.6.0","@vue/test-utils":"^2.4.6",eslint:"^9.4.0","eslint-plugin-vue":"^9.26.0",esno:"^4.7.0",gsap:"^3.12.5",husky:"^9.0.11",jsdom:"^24.1.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.2","release-it":"^17.3.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.12.0",sponsorkit:"^0.14.6",three:"^0.165.0",unocss:"^0.60.4",unplugin:"^1.10.1","unplugin-vue-components":"^0.27.0",vite:"^5.2.12","vite-plugin-banner":"^0.7.1","vite-plugin-dts":"3.9.1","vite-plugin-inspect":"^0.8.4","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.2.2",vitest:"^1.6.0",vue:"^3.4.27","vue-demi":"^0.14.8"}};function le(e){return Array.isArray(e)}function z(e){return typeof e=="function"}function q(e){return e===Object(e)&&!le(e)&&!z(e)}function $(e){return q(e)&&"isObject3D"in e&&!!e.isObject3D}function he(e){return q(e)&&"isCamera"in e&&!!e.isCamera}function tt(e){return q(e)&&"isBufferGeometry"in e&&!!e.isBufferGeometry}function nt(e){return q(e)&&"isMaterial"in e&&!!e.isMaterial}function ve(e){return q(e)&&"isFog"in e&&!!e.isFog}function ye(e){return $(e)||tt(e)||nt(e)||ve(e)}const we=({sizes:e})=>{const t=p.ref([]),n=p.computed(()=>t.value[0]),r=i=>{const a=i instanceof y.Camera?i:t.value.find(o=>o.uuid===i);if(!a)return;const d=t.value.filter(({uuid:o})=>o!==a.uuid);t.value=[a,...d]},s=(i,a=!1)=>{if(he(i)){const d=i;if(t.value.some(({uuid:o})=>o===d.uuid))return;a?r(d):t.value.push(d)}},l=i=>{if(he(i)){const a=i;t.value=t.value.filter(({uuid:d})=>d!==a.uuid)}};return p.watchEffect(()=>{e.aspectRatio.value&&t.value.forEach(i=>{!i.manual&&(i instanceof y.PerspectiveCamera||rt(i))&&(i instanceof y.PerspectiveCamera?i.aspect=e.aspectRatio.value:(i.left=e.width.value*-.5,i.right=e.width.value*.5,i.top=e.height.value*.5,i.bottom=e.height.value*-.5),i.updateProjectionMatrix())})}),p.onUnmounted(()=>{t.value=[]}),{camera:n,cameras:t,registerCamera:s,deregisterCamera:l,setCameraActive:r}};function rt(e){return e.hasOwnProperty("isOrthographicCamera")&&e.isOrthographicCamera}const be=S.createEventHook(),Me=S.createEventHook(),ce=S.createEventHook(),H=new y.Clock;let K=0,X=0;const{pause:ot,resume:Ce,isActive:it}=S.useRafFn(()=>{be.trigger({delta:K,elapsed:X,clock:H}),Me.trigger({delta:K,elapsed:X,clock:H}),ce.trigger({delta:K,elapsed:X,clock:H})},{immediate:!1});ce.on(()=>{K=H.getDelta(),X=H.getElapsedTime()});let _e=!1;const st=()=>(_e||(_e=!0,Ce()),{onBeforeLoop:be.on,onLoop:Me.on,onAfterLoop:ce.on,pause:ot,resume:Ce,isActive:it}),at=!0,Z="[TresJS ▲ ■ ●] ";function I(){function e(...r){typeof r[0]=="string"?r[0]=Z+r[0]:r.unshift(Z),console.error(...r)}function t(...r){typeof r[0]=="string"?r[0]=Z+r[0]:r.unshift(Z),console.warn(...r)}function n(r,s){}return{logError:e,logWarning:t,logMessage:n}}function lt(e){return typeof e=="number"?[e,e,e]:e instanceof y.Vector3?[e.x,e.y,e.z]:e}function Pe(e){return e instanceof y.Color?e:Array.isArray(e)?new y.Color(...e):new y.Color(e)}class ct extends ge.Mesh{constructor(...n){super(...n);me(this,"type","HightlightMesh");me(this,"createTime");this.createTime=Date.now()}onBeforeRender(){const r=(Date.now()-this.createTime)/1e3,i=1+.07*Math.sin(2.5*r);this.scale.set(i,i,i)}}const ke=(e,t)=>{for(const n of Object.keys(t))t[n]instanceof Object&&Object.assign(t[n],ke(e[n],t[n]));return Object.assign(e||{},t),e},ut=pt("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot");function Se(e){return e&&e.nodeType===1}function ee(e){return e.replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}const ft=/\B([A-Z])/g;function dt(e){return e.replace(ft,"-$1").toLowerCase()}function pt(e,t){const n=Object.create(null),r=e.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return s=>!!n[s]}const mt=(e,t)=>{const n=new Set,r=[];for(const s of e){const l=t(s);n.has(l)||(n.add(l),r.push(s))}return r},Ae=(e,t)=>{if(!t)return;const n=Array.isArray(t)?t:t.match(/([^[.\]])+/g);return n==null?void 0:n.reduce((r,s)=>r&&r[s],e)},gt=(e,t,n)=>{const r=Array.isArray(t)?t:t.match(/([^[.\]])+/g);r&&r.reduce((s,l,i)=>(s[l]===void 0&&(s[l]={}),i===r.length-1&&(s[l]=n),s[l]),e)};function Oe(e,t){if(Se(e)&&Se(t)){const s=e.attributes,l=t.attributes;return s.length!==l.length?!1:Array.from(s).every(({name:i,value:a})=>t.getAttribute(i)===a)}if(e===t)return!0;if(e===null||typeof e!="object"||t===null||typeof t!="object")return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!Oe(e[s],t[s]))return!1;return!0}function ht(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Oe(e[n],t[n]))return!1;return!0}const vt=Array.isArray;function yt(e,t,n,r){const s=d=>{if(d.uuid===t)return d;for(const o of d.children){const v=s(o);if(v)return v}},l=s(e);if(!l){console.warn("Object with UUID not found in the scene.");return}let i=l;for(let d=0;d<n.length-1;d++)if(i[n[d]]!==void 0)i=i[n[d]];else{console.warn(`Property path is not valid: ${n.join(".")}`);return}const a=n[n.length-1];i[a]!==void 0?i[a]=r:console.warn(`Property path is not valid: ${n.join(".")}`)}function wt(e){const t=new y.MeshBasicMaterial({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:y.DoubleSide});return new ct(e.geometry.clone(),t)}function bt(e){var n;let t=e.value;return e.value&&((n=e.value)!=null&&n.isMesh)&&(t=e.value.position),Array.isArray(e.value)&&(t=new y.Vector3(...t)),t}function Mt(e){return"map"in e}function Le(e){Mt(e)&&e.map&&e.map.dispose(),e.dispose()}function te(e){var n,r;if(e.parent&&((n=e.removeFromParent)==null||n.call(e)),delete e.__tres,[...e.children].forEach(s=>te(s)),!(e instanceof y.Scene)){const s=e;e&&((r=e.dispose)==null||r.call(e)),s.geometry&&(s.geometry.dispose(),delete s.geometry),Array.isArray(s.material)?(s.material.forEach(l=>Le(l)),delete s.material):s.material&&(Le(s.material),delete s.material)}}function Ct(e,t){let n=0;for(let r=0;r<e.length;r++)t(e[r],r)&&(e[n]=e[r],n++);return e.length=n,e}const _t=Number.parseInt(y.REVISION.replace("dev","")),ne={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:y.SRGBColorSpace,toneMapping:y.ACESFilmicToneMapping,toneMappingExposure:3,shadowMap:{enabled:!0,type:y.PCFSoftShadowMap}},flat:{toneMapping:y.NoToneMapping,toneMappingExposure:1}};function De({canvas:e,options:t,contextParts:{sizes:n,render:r,invalidate:s,advance:l}}){const i=p.computed(()=>({alpha:S.toValue(t.alpha)??!0,depth:S.toValue(t.depth),canvas:S.unrefElement(e),context:S.toValue(t.context),stencil:S.toValue(t.stencil),antialias:S.toValue(t.antialias)??!0,precision:S.toValue(t.precision),powerPreference:S.toValue(t.powerPreference),premultipliedAlpha:S.toValue(t.premultipliedAlpha),preserveDrawingBuffer:S.toValue(t.preserveDrawingBuffer),logarithmicDepthBuffer:S.toValue(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:S.toValue(t.failIfMajorPerformanceCaveat)})),a=p.shallowRef(new y.WebGLRenderer(i.value));function d(){t.renderMode==="on-demand"&&s()}p.watch(i,()=>{a.value.dispose(),a.value=new y.WebGLRenderer(i.value),d()}),p.watch([n.width,n.height],()=>{a.value.setSize(n.width.value,n.height.value),d()},{immediate:!0}),p.watch(()=>t.clearColor,d);const{pixelRatio:o}=S.useDevicePixelRatio();p.watch(o,()=>{a.value.setPixelRatio(o.value)});const{logError:v}=I(),c=(()=>{const f=new y.WebGLRenderer,k={shadowMap:{enabled:f.shadowMap.enabled,type:f.shadowMap.type},toneMapping:f.toneMapping,toneMappingExposure:f.toneMappingExposure,outputColorSpace:f.outputColorSpace};return f.dispose(),k})(),w=S.toValue(t.renderMode);return w==="on-demand"&&s(),w==="manual"&&setTimeout(()=>{l()},100),p.watchEffect(()=>{const f=S.toValue(t.preset);f&&(f in ne||v(`Renderer Preset must be one of these: ${Object.keys(ne).join(", ")}`),ke(a.value,ne[f])),w==="always"&&(r.frames.value=Math.max(1,r.frames.value));const k=(b,D)=>{const A=S.toValue(b),O=()=>{if(f)return Ae(ne[f],D)};if(A!==void 0)return A;const C=O();return C!==void 0?C:Ae(c,D)},g=(b,D)=>gt(a.value,D,k(b,D));g(t.shadows,"shadowMap.enabled"),g(t.toneMapping??y.ACESFilmicToneMapping,"toneMapping"),g(t.shadowMapType,"shadowMap.type"),_t<150&&g(!t.useLegacyLights,"physicallyCorrectLights"),g(t.outputColorSpace,"outputColorSpace"),g(t.toneMappingExposure,"toneMappingExposure");const M=k(t.clearColor,"clearColor");M&&a.value.setClearColor(M?Pe(M):new y.Color(0))}),p.onUnmounted(()=>{a.value.dispose(),a.value.forceContextLoss()}),{renderer:a}}const Pt=e=>!!e&&e.constructor===Array;function Te(e){const t={nodes:{},materials:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material)}),t}async function kt(e,t,n,r,s){const{logError:l}=I(),i=new e;s&&s(i),n&&n(i);const d=(Array.isArray(t)?t:[t]).map(o=>new Promise((v,m)=>{i.load(o,c=>{c.scene&&Object.assign(c,Te(c.scene)),v(c)},r,c=>m(l("[useLoader] - Failed to load resource",c)))}));return Pt(t)?await Promise.all(d):await d[0]}async function St(e,t){const n=new y.TextureLoader(t),r=s=>new Promise((l,i)=>{n.load(s,a=>l(a),()=>null,()=>{i(new Error("[useTextures] - Failed to load texture"))})});if(vt(e)){const s=await Promise.all(e.map(l=>r(l)));return e.length>1?s:s[0]}else{const{map:s,displacementMap:l,normalMap:i,roughnessMap:a,metalnessMap:d,aoMap:o,alphaMap:v,matcap:m}=e;return{map:s?await r(s):null,displacementMap:l?await r(l):null,normalMap:i?await r(i):null,roughnessMap:a?await r(a):null,metalnessMap:d?await r(d):null,aoMap:o?await r(o):null,alphaMap:v?await r(v):null,matcap:m?await r(m):null}}}const ue=(e,t)=>{const n=p.computed(()=>t.renderer.value.domElement),r=p.shallowRef([]),{x:s,y:l}=S.usePointer({target:n});let i=0;const{width:a,height:d,top:o,left:v}=S.useElementBounding(n),m=({x:h,y:T})=>{if(n.value)return{x:(h-v.value)/a.value*2-1,y:-((T-o.value)/d.value)*2+1}},c=({x:h,y:T})=>{if(t.camera.value)return t.raycaster.value.setFromCamera(new y.Vector2(h,T),t.camera.value),r.value=t.raycaster.value.intersectObjects(e.value,!0),r.value},w=h=>{const T=m({x:(h==null?void 0:h.clientX)??s.value,y:(h==null?void 0:h.clientY)??l.value});return T?c(T)||[]:[]},f=S.createEventHook(),k=S.createEventHook(),g=S.createEventHook(),M=S.createEventHook(),b=S.createEventHook(),D=S.createEventHook(),A=S.createEventHook(),O=S.createEventHook();function C(h){const T={};for(const V in h)typeof V!="function"&&(T[V]=h[V]);return T}const u=(h,T)=>{var Qe,Ke,Xe;const V=C(T),ae=new y.Vector3(T==null?void 0:T.clientX,T==null?void 0:T.clientY,0).unproject((Qe=t.camera)==null?void 0:Qe.value);h.trigger({...V,intersections:r.value,unprojectedPoint:ae,ray:(Ke=t.raycaster)==null?void 0:Ke.value.ray,camera:(Xe=t.camera)==null?void 0:Xe.value,sourceEvent:T,delta:i,stopPropagating:!1})};let _;const L=h=>{w(h),u(g,h),_=h},x=()=>{_&&L(_)};let R,j,B;const N=h=>{var T;R=(T=r.value[0])==null?void 0:T.object,i=0,j=new y.Vector2((h==null?void 0:h.clientX)??s.value,(h==null?void 0:h.clientY)??l.value),u(b,h)};let E,G=!1;const se=h=>{var T,V,ae;h instanceof PointerEvent&&(r.value.length===0&&u(D,h),R===((T=r.value[0])==null?void 0:T.object)&&(B=new y.Vector2((h==null?void 0:h.clientX)??s.value,(h==null?void 0:h.clientY)??l.value),i=j==null?void 0:j.distanceTo(B),h.button===0?(u(f,h),E===((V=r.value[0])==null?void 0:V.object)?G=!0:(E=(ae=r.value[0])==null?void 0:ae.object,G=!1)):h.button===2&&u(A,h)),u(M,h))},He=h=>{G&&(u(k,h),E=void 0,G=!1)},Ye=h=>u(g,h),Je=h=>u(O,h);return n.value.addEventListener("pointerup",se),n.value.addEventListener("pointerdown",N),n.value.addEventListener("pointermove",L),n.value.addEventListener("pointerleave",Ye),n.value.addEventListener("dblclick",He),n.value.addEventListener("wheel",Je),p.onUnmounted(()=>{n!=null&&n.value&&(n.value.removeEventListener("pointerup",se),n.value.removeEventListener("pointerdown",N),n.value.removeEventListener("pointermove",L),n.value.removeEventListener("pointerleave",Ye),n.value.removeEventListener("dblclick",He),n.value.removeEventListener("wheel",Je))}),{intersects:r,onClick:h=>f.on(h).off,onDblClick:h=>k.on(h).off,onContextMenu:h=>A.on(h).off,onPointerMove:h=>g.on(h).off,onPointerUp:h=>M.on(h).off,onPointerDown:h=>b.on(h).off,onPointerMissed:h=>D.on(h).off,onWheel:h=>O.on(h).off,forceUpdate:x}};function At(){const{logWarning:e}=I();function t(l,i,a){let d=null;return l.traverse(o=>{o[i]===a&&(d=o)}),d||e(`Child with ${i} '${a}' not found.`),d}function n(l,i,a){const d=[];return l.traverse(o=>{o[i].includes(a)&&d.push(o)}),d.length||e(`Children with ${i} '${a}' not found.`),d}function r(l,i){return t(l,"name",i)}function s(l,i){return n(l,"name",i)}return{seek:t,seekByName:r,seekAll:n,seekAllByName:s}}const Ot=e=>{const t=p.reactive({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),n=p.ref(new Set),r=m=>{n.value.add(m)},s=m=>{n.value.delete(m)},l=m=>{Object.values(t).forEach(c=>c.delete(m)),s(m)},i=m=>{const{onClick:c,onPointerMove:w,onPointerEnter:f,onPointerLeave:k}=m;c&&t.click.set(m,c),w&&t.pointerMove.set(m,w),f&&t.pointerEnter.set(m,f),k&&t.pointerLeave.set(m,k)},a=p.computed(()=>mt([...Array.from(n.value),...Object.values(t).map(m=>Array.from(m.keys())).flat()],({uuid:m})=>m));e.registerObjectAtPointerEventHandler=i,e.deregisterObjectAtPointerEventHandler=l,e.registerBlockingObjectAtPointerEventHandler=r,e.deregisterBlockingObjectAtPointerEventHandler=s;const{onClick:d,onPointerMove:o}=ue(a,e);d(({intersects:m,event:c})=>{var w;m.length&&((w=t.click.get(m[0].object))==null||w(m[0],c))});let v;return o(({intersects:m,event:c})=>{var M,b,D,A;const w=(M=m==null?void 0:m[0])==null?void 0:M.object,{pointerLeave:f,pointerEnter:k,pointerMove:g}=t;v&&v!==w&&((b=f.get(v))==null||b(v,c)),w&&(v!==w&&((D=k.get(w))==null||D(m[0],c)),(A=g.get(w))==null||A(m[0],c)),v=w||null}),{registerObject:i,deregisterObject:l,registerBlockingObject:r,deregisterBlockingObject:s}};function fe(e){let t=0;return e.traverse(n=>{if(n.isMesh&&n.geometry){const r=n.geometry,s=r.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,l=r.index?r.index.count*Uint32Array.BYTES_PER_ELEMENT:0,i=r.attributes.normal?r.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,a=r.attributes.uv?r.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,d=s+l+i+a;t+=d}}),t}function Lt(e){return(e/1024).toFixed(2)}const re=p.ref({}),oe=e=>Object.assign(re.value,e);function Dt(e,t,n=10){const r=S.toValue(e)?S.useWindowSize():S.useElementSize(p.computed(()=>S.toValue(t).parentElement)),s=p.readonly(S.refDebounced(r.width,n)),l=p.readonly(S.refDebounced(r.height,n)),i=p.computed(()=>s.value/l.value);return{height:l,width:s,aspectRatio:i}}function de(){const e=new Map,t=new Set;let n=0,r=!1;const s=()=>{const o=Array.from(e.entries()).sort((v,m)=>{const c=v[1].priority-m[1].priority;return c===0?v[1].addI-m[1].addI:c});t.clear(),o.forEach(v=>t.add(v[0]))},l=o=>{e.delete(o),t.delete(o)};return{on:(o,v=0)=>{e.set(o,{priority:v,addI:n++});const m=()=>l(o);return S.tryOnScopeDispose(m),r=!0,{off:m}},off:l,trigger:(...o)=>{r&&(s(),r=!1),t.forEach(v=>v(...o))},dispose:()=>{e.clear(),t.clear()},get count(){return e.size}}}function xe(){let e=!0,t=!0,n=!1;const r=new y.Clock(!1),s=p.ref(r.running),l=p.ref(!1);let i;const a=y.MathUtils.generateUUID();let d=null;const o=de(),v=de(),m=de();C();let c={};function w(u){c=u}function f(u,_,L=0){switch(_){case"before":return o.on(u,L);case"render":return d||(d=u),v.dispose(),v.on(u);case"after":return m.on(u,L)}}function k(){t&&(t=!1,C(),O())}function g(){t=!0,C(),cancelAnimationFrame(i)}function M(){n=!1,C()}function b(){n=!0,C()}function D(){l.value=!0}function A(){l.value=!1}function O(){if(!e){i=requestAnimationFrame(O);return}const u=r.getDelta(),_=r.getElapsedTime(),L={camera:p.unref(c.camera),scene:p.unref(c.scene),renderer:p.unref(c.renderer),raycaster:p.unref(c.raycaster),controls:p.unref(c.controls),invalidate:c.invalidate,advance:c.advance},x={delta:u,elapsed:_,clock:r,...L};s.value&&o.trigger(x),l.value||(v.count?v.trigger(x):d&&d(x)),s.value&&m.trigger(x),i=requestAnimationFrame(O)}function C(){const u=!t&&!n;r.running!==u&&(r.running?r.stop():r.start()),s.value=r.running}return{loopId:a,register:(u,_,L)=>f(u,_,L),start:k,stop:g,pause:b,resume:M,pauseRender:D,resumeRender:A,isRenderPaused:l,isActive:s,setContext:w,setReady:u=>e=u}}function Tt(e,t,n=100){n=n<=0?100:n;const r=S.createEventHook(),s=new Set;let l=!1,i=!1,a=null;function d(){a&&clearTimeout(a),!i&&!l&&e()?(r.trigger(t),s.forEach(c=>c()),s.clear(),l=!0):!i&&!l&&(a=setTimeout(d,n))}function o(){i=!0,a&&clearTimeout(a)}d();const v=(c,...w)=>{c(...w)};return{on:c=>{if(l)return v(c,t),{off:()=>{}};{const w=r.on(c);return s.add(w.off),r.on(c)}},off:r.off,trigger:r.trigger,cancel:o}}const Y=new WeakMap;function je(e){if(e=e||J(),Y.has(e))return Y.get(e);const t=100,n=Date.now(),l=Tt(()=>{if(Date.now()-n>=t)return!0;{const i=e.renderer.value,a=(i==null?void 0:i.domElement)||{width:0,height:0};return!!(i&&a.width>0&&a.height>0)}},e);return Y.set(e,l),l}function xt(e){const t=J();if(t)return Y.has(t)?Y.get(t).on(e):je(t).on(e)}function Be({scene:e,canvas:t,windowSize:n,disableRender:r,rendererOptions:s,emit:l}){const{logWarning:i}=I(),a=p.shallowRef(e),d=Dt(n,t),{camera:o,cameras:v,registerCamera:m,deregisterCamera:c,setCameraActive:w}=we({sizes:d,scene:e}),f={mode:p.ref(s.renderMode||"always"),priority:p.ref(0),frames:p.ref(0),maxFrames:60,canBeInvalidated:p.computed(()=>f.mode.value==="on-demand"&&f.frames.value===0)};function k(E=1){s.renderMode==="on-demand"?f.frames.value=Math.min(f.maxFrames,f.frames.value+E):i("`invalidate` can only be used when `renderMode` is set to `on-demand`")}function g(){s.renderMode==="manual"?f.frames.value=1:i("`advance` can only be used when `renderMode` is set to `manual`")}const{renderer:M}=De({scene:e,canvas:t,options:s,emit:l,contextParts:{sizes:d,camera:o,render:f,invalidate:k,advance:g},disableRender:r}),b={sizes:d,scene:a,camera:o,cameras:p.readonly(v),renderer:M,raycaster:p.shallowRef(new y.Raycaster),controls:p.ref(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},render:f,advance:g,extend:oe,invalidate:k,registerCamera:m,setCameraActive:w,deregisterCamera:c,loop:xe()};p.provide("useTres",b),b.scene.value.__tres={root:b},b.loop.register(()=>{o.value&&f.frames.value>0&&(M.value.render(e,o.value),l("render",b.renderer.value)),f.priority.value=0,f.mode.value==="always"?f.frames.value=1:f.frames.value=Math.max(0,f.frames.value-1)},"render");const{on:D,cancel:A}=je(b);b.loop.setReady(!1),b.loop.start(),D(()=>{l("ready",b),b.loop.setReady(!0)}),p.onUnmounted(()=>{A(),b.loop.stop()});const O=100,C=S.useFps({every:O}),{isSupported:u,memory:_}=S.useMemory({interval:O}),L=160;let x=performance.now();const R=({timestamp:E})=>{b.scene.value&&(b.perf.memory.allocatedMem=fe(b.scene.value)),E-x>=O&&(x=E,b.perf.fps.accumulator.push(C.value),b.perf.fps.accumulator.length>L&&b.perf.fps.accumulator.shift(),b.perf.fps.value=C.value,u.value&&_.value&&(b.perf.memory.accumulator.push(_.value.usedJSHeapSize/1024/1024),b.perf.memory.accumulator.length>L&&b.perf.memory.accumulator.shift(),b.perf.memory.currentMem=b.perf.memory.accumulator.reduce((G,se)=>G+se,0)/b.perf.memory.accumulator.length))};let j=0;const B=1,{pause:N}=S.useRafFn(({delta:E})=>{window.__TRES__DEVTOOLS__&&(R({timestamp:performance.now()}),j+=E,j>=B&&(window.__TRES__DEVTOOLS__.cb(b),j=0))},{immediate:!0});return p.onUnmounted(()=>{N()}),b}function J(){const e=p.inject("useTres");if(!e)throw new Error("useTresContext must be used together with useTresContextProvider");return e}const jt=J;function Bt(){const{camera:e,scene:t,renderer:n,loop:r,raycaster:s,controls:l,invalidate:i,advance:a}=J();r.setContext({camera:e,scene:t,renderer:n,raycaster:s,controls:l,invalidate:i,advance:a});function d(m,c=0){return r.register(m,"before",c)}function o(m){return r.register(m,"render")}function v(m,c=0){return r.register(m,"after",c)}return{pause:r.pause,resume:r.resume,pauseRender:r.pauseRender,resumeRender:r.resumeRender,isActive:r.isActive,onBeforeRender:d,render:o,onAfterRender:v}}function Ee(e,t,n){const r=p.shallowRef(),s=p.shallowRef();e&&(r.value=e),t&&(s.value=t);const l=u=>{var _;return((_=u.__tres)==null?void 0:_.eventCount)>0},i=u=>{var _;return((_=u.children)==null?void 0:_.some(L=>i(L)))||l(u)},a=p.computed(()=>{var u,_;return((_=(u=r.value)==null?void 0:u.children)==null?void 0:_.filter(i))||[]});function d(u,_){if(Array.isArray(u))for(const L of u)L(_);typeof u=="function"&&u(_)}function o(u,_){const L=[],x=()=>_.stopPropagating=!0;_.stopPropagation=x;for(const R of _==null?void 0:_.intersections){if(_.stopPropagating)return;_={..._,...R};const{object:j}=R;_.eventObject=j,d(j[u],_),L.push(j);let B=j.parent;for(;B!==null&&!_.stopPropagating&&!L.includes(B);)_.eventObject=B,d(B[u],_),L.push(B),B=B.parent;const N=dt(u.slice(2));n(N,{intersection:R,event:_})}}const{onClick:v,onDblClick:m,onContextMenu:c,onPointerMove:w,onPointerDown:f,onPointerUp:k,onPointerMissed:g,onWheel:M,forceUpdate:b}=ue(a,t);k(u=>o("onPointerUp",u)),f(u=>o("onPointerDown",u)),v(u=>o("onClick",u)),m(u=>o("onDoubleClick",u)),c(u=>o("onContextMenu",u)),M(u=>o("onWheel",u));let D=[];w(u=>{const _=u.intersections.map(({object:x})=>x),L=u.intersections;D.forEach(({object:x})=>{_.includes(x)||(u.intersections=D,o("onPointerLeave",u),o("onPointerOut",u))}),u.intersections=L,u.intersections.forEach(({object:x})=>{D.includes(x)||(o("onPointerEnter",u),o("onPointerOver",u))}),o("onPointerMove",u),D=u.intersections});const A=[];g(u=>{const _=()=>u.stopPropagating=!0;u.stopPropagation=_,A.forEach(L=>{u.stopPropagating||(u.eventObject=L,d(L.onPointerMissed,u))}),n("pointer-missed",{event:u})});function O(u){ye(u)&&$(u)&&u.onPointerMissed&&A.push(u)}function C(u){if(ye(u)&&$(u)){const _=A.indexOf(u);_>-1&&A.splice(_,1)}}return t.eventManager={forceUpdate:b,registerPointerMissedObject:O,deregisterPointerMissedObject:C},{forceUpdate:b,registerPointerMissedObject:O,deregisterPointerMissedObject:C}}function Ie(e,t,n){const r=e;return r.__tres={type:"unknown",eventCount:0,root:n,handlers:{},memoizedProps:{},objects:[],parent:null,...t},r}function Ue(e){var n;const t=(n=e==null?void 0:e.__tres)==null?void 0:n.root;t&&t.render&&t.render.canBeInvalidated.value&&t.invalidate()}function Sn(e){}const{logError:Fe}=I(),Re=["onClick","onContextMenu","onPointerMove","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onDoubleClick","onPointerDown","onPointerUp","onPointerCancel","onPointerMissed","onLostPointerCapture","onWheel"],Et=e=>{const t=e.scene.value;function n(o,v,m,c){if(c||(c={}),c.args||(c.args=[]),o==="template"||ut(o))return null;let w=o.replace("Tres",""),f;if(o==="primitive"){(c==null?void 0:c.object)===void 0&&Fe("Tres primitives need a prop 'object'");const k=c.object;w=k.type,f=Object.assign(k.clone(),{type:w})}else{const k=re.value[w];k||Fe(`${w} is not defined on the THREE namespace. Use extend to add it to the catalog.`),f=new k(...c.args)}return f?(f.isCamera&&(c!=null&&c.position||f.position.set(3,3,3),c!=null&&c.lookAt||f.lookAt(0,0,0)),(c==null?void 0:c.attach)===void 0&&(f.isMaterial?f.attach="material":f.isBufferGeometry&&(f.attach="geometry")),f=Ie(f,{...f.__tres,type:w,memoizedProps:c,eventCount:0,disposable:!0,primitive:o==="primitive"},e),f.isObject3D&&f.__tres&&(c!=null&&c.material||c!=null&&c.geometry)&&(f.__tres.disposable=!1),f):null}function r(o,v){var f,k;if(!o)return;const m=o.__tres?o:Ie(o,{}),c=v||t;e.registerCamera(o),(f=e.eventManager)==null||f.registerPointerMissedObject(o);let w=!1;$(o)&&$(c)?(c.add(o),w=!0,o.dispatchEvent({type:"added"})):ve(o)?c.fog=o:typeof o.attach=="string"&&(o.__previousAttach=o[c==null?void 0:c.attach],c&&(c[o.attach]=o)),m.__tres.parent=c,(k=c.__tres)!=null&&k.objects&&!w&&(c.__tres.objects.includes(o)||c.__tres.objects.push(o))}function s(o){var m,c,w,f,k;if(!o)return;o.parent=o.parent||t;const v=((m=o.__tres)==null?void 0:m.parent)||t;o.__tres&&(o.__tres.parent=null),v.__tres&&"objects"in v.__tres&&Ct(v.__tres.objects,g=>g!==o),$(o)&&((c=o.removeFromParent)==null||c.call(o),o.traverse(M=>{var b;e.deregisterCamera(M),(b=e.eventManager)==null||b.deregisterPointerMissedObject(M)}),e.deregisterCamera(o),Ue(o),!((w=o.__tres)!=null&&w.primitive)&&((f=o.__tres)!=null&&f.disposable)&&te(o),(k=o.dispose)==null||k.call(o))}function l(o,v,m,c){var b,D;if(!o)return;let w=o,f=v;if((b=o.__tres)!=null&&b.primitive&&f==="object"&&m!==null){const A=n("primitive",void 0,void 0,{object:c});for(const O in A){if(O==="uuid")continue;const C=o[O],u=A[O];!(C!=null&&C.set)&&!z(C)?o[O]=u:C.constructor===u.constructor&&(C!=null&&C.copy)?C==null||C.copy(u):Array.isArray(u)?C.set(...u):!C.isColor&&C.setScalar?C.setScalar(u):C.set(u)}A!=null&&A.__tres&&(A.__tres.root=e),A!=null&&A.isGroup?(o.geometry=void 0,o.material=void 0):delete o.isGroup}if($(o)&&f==="blocks-pointer-events"){c||c===""?o[f]=c:delete o[f];return}Re.includes(v)&&(o.__tres.eventCount+=1);let k=ee(f),g=w==null?void 0:w[k];if(f==="args"){const A=o,O=m??[],C=c??[],u=((D=o.__tres)==null?void 0:D.type)||o.type;u&&O.length&&!ht(O,C)&&(w=Object.assign(A,new re.value[u](...c)));return}if(w.type==="BufferGeometry"){if(f==="args")return;w.setAttribute(ee(f),new y.BufferAttribute(...c));return}if(f.includes("-")&&g===void 0){const A=f.split("-");g=A.reduce((O,C)=>O[ee(C)],w),f=A.pop(),k=f,g!=null&&g.set||(w=A.reduce((O,C)=>O[ee(C)],w))}let M=c;if(M===""&&(M=!0),z(g)){Re.includes(v)||(le(M)?o[k](...M):o[k](M)),k.startsWith("on")&&z(M)&&(w[k]=M);return}!(g!=null&&g.set)&&!z(g)?w[k]=M:g.constructor===M.constructor&&(g!=null&&g.copy)?g==null||g.copy(M):le(M)?g.set(...M):!g.isColor&&g.setScalar?g.setScalar(M):g.set(M),Ue(o)}function i(o){return(o==null?void 0:o.parent)||null}function a(o){const v=new y.Object3D;return v.name=o,v.__tres={type:"Comment"},v.__tres.root=t==null?void 0:t.__tres.root,v}function d(o){if(!o)return null;const v=o.parent||t,m=v.children.indexOf(o);return v.children[m+1]||null}return{insert:r,remove:s,createElement:n,patchProp:l,parentNode:i,createText:()=>void 0,createComment:a,setText:()=>void 0,setElementText:()=>void 0,nextSibling:d,querySelector:()=>void 0,setScopeId:()=>void 0,cloneNode:()=>void 0,insertStaticContent:()=>void 0}};function It(){return Ve().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Ve(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const Ut=typeof Proxy=="function",Ft="devtools-plugin:setup",Rt="plugin:settings:set";let W,pe;function Vt(){var e;return W!==void 0||(typeof window<"u"&&window.performance?(W=!0,pe=window.performance):typeof globalThis<"u"&&(!((e=globalThis.perf_hooks)===null||e===void 0)&&e.performance)?(W=!0,pe=globalThis.perf_hooks.performance):W=!1),W}function $t(){return Vt()?pe.now():Date.now()}class Wt{constructor(t,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=n;const r={};if(t.settings)for(const i in t.settings){const a=t.settings[i];r[i]=a.defaultValue}const s=`__vue-devtools-plugin-settings__${t.id}`;let l=Object.assign({},r);try{const i=localStorage.getItem(s),a=JSON.parse(i);Object.assign(l,a)}catch{}this.fallbacks={getSettings(){return l},setSettings(i){try{localStorage.setItem(s,JSON.stringify(i))}catch{}l=i},now(){return $t()}},n&&n.on(Rt,(i,a)=>{i===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(i,a)=>this.target?this.target.on[a]:(...d)=>{this.onQueue.push({method:a,args:d})}}),this.proxiedTarget=new Proxy({},{get:(i,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...d)=>(this.targetQueue.push({method:a,args:d,resolve:()=>{}}),this.fallbacks[a](...d)):(...d)=>new Promise(o=>{this.targetQueue.push({method:a,args:d,resolve:o})})})}async setRealTarget(t){this.target=t;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function Nt(e,t){const n=e,r=Ve(),s=It(),l=Ut&&n.enableEarlyProxy;if(s&&(r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!l))s.emit(Ft,e,t);else{const i=l?new Wt(n,s):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:t,proxy:i}),i&&t(i.proxiedTarget)}}function Gt(e,t){const n=`▲ ■ ●${e}`;typeof $e=="function"?$e(n,t):console.log(n)}function $e(e,t){throw new Error(e+t)}const We=e=>{const t={id:e.uuid,label:e.type,children:[],tags:[]};e.name!==""&&t.tags.push({label:e.name,textColor:5750629,backgroundColor:15793395});const n=fe(e);return n>0&&t.tags.push({label:`${Lt(n)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),e.type.includes("Light")&&(t.tags.push({label:`${e.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),t.tags.push({label:`#${e.color.getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),e.type.includes("Camera")&&(t.tags.push({label:`${e.fov}°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),t.tags.push({label:`x: ${Math.round(e.position.x)} y: ${Math.round(e.position.y)} z: ${Math.round(e.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),t};function Ne(e,t,n=""){e.children.forEach(r=>{if(r.type==="HightlightMesh"||n&&!r.type.includes(n)&&!r.name.includes(n))return;const s=We(r);t.children.push(s),Ne(r,s,n)})}const zt=[],Q="tres:inspector",qt=p.reactive({sceneGraph:null});function Ht(e,t){Nt({id:"dev.esm.tres",label:"TresJS 🪐",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:zt,app:e},n=>{typeof n.now!="function"&&Gt("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),n.addInspector({id:Q,label:"TresJS 🪐",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{n.sendInspectorTree(Q)},1e3),setInterval(()=>{n.notifyComponentUpdate()},5e3),n.on.getInspectorTree(l=>{if(l.inspectorId===Q){const i=We(t.scene.value);Ne(t.scene.value,i,l.filter),qt.sceneGraph=i,l.rootNodes=[i]}});let r=null,s=null;n.on.getInspectorState(l=>{var i;if(l.inspectorId===Q){const[a]=t.scene.value.getObjectsByProperty("uuid",l.nodeId);if(!a)return;if(s&&r&&r.parent&&s.remove(r),a.isMesh){const d=wt(a);a.add(d),r=d,s=a}l.state={object:[{key:"uuid",editable:!0,value:a.uuid},{key:"name",editable:!0,value:a.name},{key:"type",editable:!0,value:a.type},{key:"position",editable:!0,value:a.position},{key:"rotation",editable:!0,value:a.rotation},{key:"scale",editable:!0,value:a.scale},{key:"geometry",value:a.geometry},{key:"material",value:a.material},{key:"color",editable:!0,value:a.color},{key:"intensity",editable:!0,value:a.intensity},{key:"castShadow",editable:!0,value:a.castShadow},{key:"receiveShadow",editable:!0,value:a.receiveShadow},{key:"frustumCulled",editable:!0,value:a.frustumCulled},{key:"matrixAutoUpdate",editable:!0,value:a.matrixAutoUpdate},{key:"matrixWorldNeedsUpdate",editable:!0,value:a.matrixWorldNeedsUpdate},{key:"matrixWorld",value:a.matrixWorld},{key:"visible",editable:!0,value:a.visible}]},a.isScene&&(l.state.info={memory:fe(a),objects:a.children.length,calls:t.renderer.value.info.render.calls,triangles:t.renderer.value.info.render.triangles,points:t.renderer.value.info.render.points,lines:t.renderer.value.info.render.lines},l.state.programs=((i=t.renderer.value.info.programs)==null?void 0:i.map(d=>({key:d.name,value:{...d,vertexShader:d.vertexShader,attributes:d.getAttributes(),uniforms:d.getUniforms()}})))||[])}}),n.on.editInspectorState(l=>{l.inspectorId===Q&&yt(t.scene.value,l.nodeId,l.path,l.state.value)})})}const Yt=["data-scene","data-tres"],Ge=p.defineComponent({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},emits:["render","click","double-click","context-menu","pointer-move","pointer-up","pointer-down","pointer-enter","pointer-leave","pointer-over","pointer-out","pointer-missed","wheel","ready"],setup(e,{expose:t,emit:n}){var k;const r=e,s=n,l=p.useSlots(),{logWarning:i}=I(),a=p.ref(),d=p.shallowRef(new y.Scene),o=(k=p.getCurrentInstance())==null?void 0:k.appContext.app;oe(ge);const v=g=>p.defineComponent({setup(){var b;const M=(b=p.getCurrentInstance())==null?void 0:b.appContext;return M&&(M.app=o),p.provide("useTres",g),p.provide("extend",oe),typeof window<"u"&&Ht(M==null?void 0:M.app,g),()=>p.h(p.Fragment,null,l!=null&&l.default?l.default():[])}}),m=g=>{const M=v(g),{render:b}=p.createRenderer(Et(g));b(p.h(M),d.value)},c=(g,M=!1)=>{te(g.scene.value),M&&(g.renderer.value.dispose(),g.renderer.value.renderLists.dispose(),g.renderer.value.forceContextLoss()),d.value.__tres={root:g},m(g)},w=p.computed(()=>r.disableRender),f=p.shallowRef(null);return t({context:f,dispose:()=>c(f.value,!0)}),p.onMounted(()=>{const g=a;f.value=Be({scene:d.value,canvas:g,windowSize:r.windowSize??!1,disableRender:w.value??!1,rendererOptions:r,emit:s}),Ee(d.value,f.value,s);const{registerCamera:M,camera:b,cameras:D,deregisterCamera:A}=f.value;m(f.value);const O=()=>{const C=new y.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3);C.position.set(3,3,3),C.lookAt(0,0,0),M(C);const u=p.watchEffect(()=>{D.value.length>=2&&(C.removeFromParent(),A(C),u==null||u())})};p.watch(()=>r.camera,(C,u)=>{C&&M(C),u&&(u.removeFromParent(),A(u))},{immediate:!0}),b.value||(i("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),O())}),p.onUnmounted(()=>{c(f.value)}),(g,M)=>(p.openBlock(),p.createElementBlock("canvas",{ref_key:"canvas",ref:a,"data-scene":d.value.uuid,class:p.normalizeClass(g.$attrs.class),"data-tres":`tresjs ${p.unref(et).version}`,style:p.normalizeStyle({display:"block",width:"100%",height:"100%",position:g.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...g.$attrs.style})},null,14,Yt))}}),Jt=["TresCanvas","TresLeches","TresScene"],Qt={template:{compilerOptions:{isCustomElement:e=>e.startsWith("Tres")&&!Jt.includes(e)||e==="primitive"}}},Kt={mounted:(e,t)=>{if(t.arg){console.log(`v-log:${t.arg}`,e[t.arg]);return}console.log("v-log",e)}};class ze extends y.Line{constructor(t,n){const r=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],s=new y.BufferGeometry;s.setAttribute("position",new y.Float32BufferAttribute(r,3)),s.computeBoundingSphere();const l=new y.LineBasicMaterial({fog:!1});super(s,l),this.light=t,this.color=n,this.type="RectAreaLightHelper";const i=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],a=new y.BufferGeometry;a.setAttribute("position",new y.Float32BufferAttribute(i,3)),a.computeBoundingSphere(),this.add(new y.Mesh(a,new y.MeshBasicMaterial({side:y.BackSide,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const t=this.material.color,n=Math.max(t.r,t.g,t.b);n>1&&t.multiplyScalar(1/n),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const{logWarning:qe}=I();let ie,F;const Xt={DirectionalLight:y.DirectionalLightHelper,PointLight:y.PointLightHelper,SpotLight:y.SpotLightHelper,HemisphereLight:y.HemisphereLightHelper,RectAreaLight:ze},Zt={mounted:e=>{if(!e.isLight){qe(`${e.type} is not a light`);return}ie=Xt[e.type],e.parent.add(new ie(e,1,e.color.getHex()))},updated:e=>{F=e.parent.children.find(t=>t instanceof ie),!(F instanceof ze)&&F.update()},unmounted:e=>{if(!e.isLight){qe(`${e.type} is not a light`);return}F=e.parent.children.find(t=>t instanceof ie),F&&F.dispose&&F.dispose(),e.parent.remove(F)}},{logWarning:en}=I();let U=null;const tn={updated:(e,t)=>{var s;const n=bt(t);if(!n){en(`v-distance-to: problem with binding value: ${t.value}`);return}U&&(U.dispose(),e.parent.remove(U));const r=n.clone().sub(e.position);r.normalize(),U=new y.ArrowHelper(r,e.position,e.position.distanceTo(n),16776960),e.parent.add(U),console.table([["Distance:",e.position.distanceTo(n)],[`origin: ${e.name||e.type}`,`x:${e.position.x}, y:${e.position.y}, z:${(s=e.position)==null?void 0:s.z}`],[`Destiny: ${e.name||e.type}`,`x:${n.x}, y:${n.y}, z:${n==null?void 0:n.z}`]])},unmounted:e=>{U==null||U.dispose(),e.parent.remove(U)}},nn={install(e){e.component("TresCanvas",Ge)}};P.TresCanvas=Ge,P.catalogue=re,P.createRenderLoop=xe,P.default=nn,P.dispose=te,P.extend=oe,P.isProd=at,P.normalizeColor=Pe,P.normalizeVectorFlexibleParam=lt,P.onTresReady=xt,P.templateCompilerOptions=Qt,P.trasverseObjects=Te,P.useCamera=we,P.useLoader=kt,P.useLogger=I,P.useLoop=Bt,P.usePointerEventHandler=Ot,P.useRaycaster=ue,P.useRenderLoop=st,P.useRenderer=De,P.useSeek=At,P.useTexture=St,P.useTres=jt,P.useTresContext=J,P.useTresContextProvider=Be,P.useTresEventManager=Ee,P.vDistanceTo=tn,P.vLightHelper=Zt,P.vLog=Kt,Object.defineProperties(P,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
